define("tmpl/report_abuse/modal",["handlebars-runtime"],function(a){return a.template({compiler:[6,">= 2.0.0-beta.1"],main:function(){return'<div id="report-modal" class="view view--modalSnap display--none reportingOverlay">\n</div>\n\n<div id="report-shim" class="overlayShim display--none">\n    <div class="overlayShim-content inverted">\n    </div>\n</div>'},useData:!0})}),function(){define("shared/report_abuse",["core/api","core/constants","core/data","core/trn","tmpl/report_abuse/modal"],function(a,b,c,d,e){function f(c){c+="modal/",a.RemoteApi.get({url:c,method:"get"}).done(function(a){p.innerHTML=a,t=document.getElementById("reason-view"),v=document.getElementById("moreInformation-view"),z=document.getElementById("thanks-view"),A=document.getElementById("error-view"),v.classList.add(b.DISPLAY_NONE),z.classList.add(b.DISPLAY_NONE),A.classList.add(b.DISPLAY_NONE),r=document.getElementById("report-modal-closer"),s=document.getElementById("reason-submit"),w=document.getElementById("moreInfo-text"),x=document.getElementById("csrf-token"),y=document.getElementById("moreInformation-submit"),B=document.getElementById("thanks-submit"),C=document.getElementById("error-submit"),u=p.querySelectorAll("input[name=report_reason]"),s.setAttribute("disabled",!0),Array.from(u).forEach(function(a){a.addEventListener("change",g)}),document.onkeydown=k,r.addEventListener("click",l),s.addEventListener("click",h)})}function g(){s.removeAttribute("disabled")}function h(a){a.preventDefault();var d=Array.from(u).filter(function(a){return a.checked})[0],e=c.get("reportReasonLinks"),f=e[d.value];if(f)return void(window.location.href=f);c.set("reportReason",d.value);var g=d.getAttribute("id"),h=document.querySelector('label[for="'+g+'"]').textContent;c.set("reportReasonName",h);var k=p.querySelector('input[name="contentType"]').value,l=p.querySelector('input[name="contentId"]').value;if(c.set("contentType",k),c.set("contentId",l),"group"===k){var m=p.querySelector('input[name="groupUrlName"]').value;c.set("groupUrlName",m)}t.classList.add(b.DISPLAY_NONE),document.getElementById("reporting-reason").innerHTML=h,v.classList.remove(b.DISPLAY_NONE),w.addEventListener("input",i),y.addEventListener("click",j)}function i(){var a=w.value.length,c=D-a,d=document.getElementById("moreInfo-text-counter");d.textContent=c,d.classList.remove(b.DISPLAY_NONE)}function j(d){d.preventDefault();var e="/self/abuse_reports",f={},g=c.get("contentId"),h=c.get("contentType");if(e=e+"?content_type="+h,"group"===h){var i=c.get("groupUrlName");e="/"+i+"/abuse_reports"}f.comments=w.value,f.content_tag=h+":"+g;var j=c.get("abuserMemberId");j&&(f.member_id=j),"member_profile"===h&&(f.member_id=c.get("contentId")),f.type=c.get("reportReason"),f.url=window.location.href,f.csrf_token=x.value,a.PublicApi().post(e,f).done(function(){z.classList.remove(b.DISPLAY_NONE),B.addEventListener("click",l)}).fail(function(){A.classList.remove(b.DISPLAY_NONE),C.addEventListener("click",l)}).always(function(){v.classList.add(b.DISPLAY_NONE)})}function k(a){a=a||window.event;var b=!1;b="key"in a?"Escape"==a.key:27==a.keyCode,b&&l(a)}function l(a){a.stopPropagation(),p.classList.add(b.DISPLAY_NONE),q.classList.add(b.DISPLAY_NONE)}function m(){var b="/report_abuse/reasons/links/";a.RemoteApi.get({url:b,dataType:"json"}).done(function(a){c.set("reportReasonLinks",a)})}function n(){var a=document.getElementsByClassName("j-report-abuse");Array.from(a).forEach(function(a){a.addEventListener("click",E)}),this&&this.addEventListener("convocontrols:showreportmodal",E,!1)}function o(){var a=e(),b=document.createElement("div");b.innerHTML=a,Array.from(b.childNodes).forEach(function(a){document.body.appendChild(a)}),p=document.getElementById("report-modal"),q=document.getElementById("report-shim"),n(),m()}var p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=500,E=function(a){a.preventDefault();var c=a.target;c.classList.contains("j-report-abuse")||(c=a.currentTarget);var d=c.getAttribute("FORM"===c.nodeName?"action":"href");f(d),window.scrollTo(0,0),p.classList.remove(b.DISPLAY_NONE),q.classList.remove(b.DISPLAY_NONE)};return{init:o,showReportModal:E}})}(),function(){require(["jquery","shared/report_abuse"],function(a,b){a(b.init)})}(),define("site/abuse/report_abuse",function(){});
//# sourceMappingURL=report_abuse.map